{% extends "base.html" %}
{% block content %}
<div class="max-w-4xl mx-auto p-6">
  <h2 class="text-3xl font-bold text-slate-900 dark:text-white mb-6">Your Servers</h2>

  <!-- Buttons -->
  <div class="flex items-center gap-3 mb-6">
    <a href="{% url 'create_server' %}"
       class="px-4 py-2 bg-indigo-600 text-white rounded-lg shadow hover:bg-indigo-700 transition">
       + Create Server
    </a>
    <button onclick="document.getElementById('joinModal').showModal()"
            class="px-4 py-2 border border-indigo-600 text-indigo-600 rounded-lg hover:bg-indigo-50 dark:hover:bg-indigo-900 transition">
      Join Server
    </button>
  </div>

  <!-- List of Servers -->
  {% if servers %}
  <div class="grid gap-4">
    {% for server in servers %}
      <a href="{% url 'server_detail' server.id %}" 
         class="block p-5 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl shadow hover:shadow-lg transition">
        <div class="flex justify-between items-center">
          <div>
            <h3 class="text-xl font-semibold text-slate-900 dark:text-white">{{ server.name }}</h3>
            <p class="text-slate-600 dark:text-slate-400 text-sm mt-1">{{ server.description|truncatechars:80 }}</p>
          </div>
          <span class="text-xs font-mono bg-indigo-100 dark:bg-indigo-800 text-indigo-700 dark:text-indigo-300 px-3 py-1 rounded-full">
            Code: {{ server.code }}
          </span>
        </div>
      </a>
    {% endfor %}
  </div>
  {% else %}
  <p class="text-slate-600 dark:text-slate-400 mt-4">You haven't joined any servers yet.</p>
  {% endif %}
</div>

<!-- Join Modal -->
<dialog id="joinModal" class="rounded-lg p-6 shadow-xl backdrop:bg-black/60">
  <form method="POST" action="{% url 'join_server' %}" class="flex flex-col gap-4">
    {% csrf_token %}
    <h3 class="text-2xl font-semibold text-slate-900 dark:text-white">Join Server</h3>
    <input type="text" name="code" placeholder="Enter Server Code" required
           class="border border-slate-300 dark:border-slate-600 rounded-lg px-3 py-2 w-full focus:ring focus:ring-indigo-300 dark:bg-slate-800 dark:text-white">
    <div class="flex justify-end gap-3 mt-2">
      <button type="button" onclick="this.closest('dialog').close()"
              class="px-4 py-2 border border-slate-400 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700">Cancel</button>
      <button type="submit"
              class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">Join</button>
    </div>
  </form>
</dialog>
{% endblock %}
